======================================================================
Testing Ours Exhaustive Search with 4-layer Synthetic Model
======================================================================

Model: 4 layers, 3 edges
Servers: 2
Bandwidth: 100 Mbps

======================================================================
Running Exhaustive Search...
======================================================================

[Ours Exhaustive Search] Starting partition generation for 4 layers...
[Ours] Generated 15 total partition schemes (Bell number)
[Ours] 8 schemes satisfy memory constraints

Partitions generated: 8 schemes

[Ours Exhaustive Search] Starting exhaustive search...
  Partition schemes to evaluate: 8
  [New Best] Scheme 0, Assignment {0: 0, 1: 0, 2: 0, 3: 0} → 40174.52 ms
  [New Best] Scheme 0, Assignment {0: 0, 1: 0, 2: 0, 3: 1} → 18687.26 ms
  [New Best] Scheme 0, Assignment {0: 0, 1: 0, 2: 1, 3: 1} → 12155.00 ms

[Ours] Exhaustive search completed!
  Total evaluations: 64
  Optimal partition scheme: 0
  Optimal server assignment: {0: 0, 1: 0, 2: 1, 3: 1}
  Optimal inference time: 12155.00 ms

======================================================================
Optimal Solution Found
======================================================================
Optimal Time: 12155.0000 ms
Optimal Partitions: 4 partitions
  Partition 0: layers [0] → Server 0
    Memory: 30.0 MB, Workload: 1000.0 M FLOPs
  Partition 1: layers [1] → Server 0
    Memory: 50.0 MB, Workload: 4000.0 M FLOPs
  Partition 2: layers [2] → Server 1
    Memory: 20.0 MB, Workload: 4000.0 M FLOPs
  Partition 3: layers [3] → Server 1
    Memory: 50.0 MB, Workload: 3000.0 M FLOPs

======================================================================
Test PASSED - Algorithm executed successfully!
======================================================================
